================================================================================
MEMORY PROFILE COMPARISON: Baseline vs. Optimized
================================================================================

TOTAL ALLOCATION SPACE
----------------------
Baseline:  ████████████████████████████████████████████████████  13,802 MB (100%)
Optimized: ███████████████████████████████████████████████████   13,122 MB (95%)
                                                    Reduction: 680 MB (4.9%)

BREAKDOWN BY HOTSPOT
--------------------

1. RowSet.Add (Target: ELIMINATE)
   Baseline:  ████████████████████████████████████████  5,032 MB (36.5%)
   Optimized: ███████████████████████████████████████   4,929 MB (37.6%)
              ⚠️  Only 2% reduction - streaming bridge issue

2. ColumnMatchResult.AddMatch
   Baseline:  █████████████████████████  3,251 MB (23.6%)
   Optimized: ████████████████████████   3,225 MB (24.6%)
              ⚠️  Only 0.8% reduction - related to RowSet issue

3. fmt.Sprintf (Target: REDUCE)
   Baseline:  ███  372 MB (21.7% of allocations by count)
   Optimized: █    164 MB
              ✅ 56% reduction - string interning working!

4. extractGroupKeyValues (Target: ELIMINATE)
   Baseline:  ███  366 MB (18.4% of allocations by count)
   Optimized:      0 MB
              ✅ 100% eliminated - buffer reuse working!

5. I/O and Decompression (Unavoidable)
   Baseline:  ████████████  1,500 MB (11%)
   Optimized: ████████████  1,540 MB (11%)
              (Slight increase due to more iterations)

NEW ALLOCATION SOURCES (Infrastructure Overhead)
-------------------------------------------------
StringInterner.InternConcat:       310 MB (2.4%)
concatenateGroupKeyFromSlice:      126 MB (1.0%)
                          Total:   436 MB (3.3%)

These are the cost of interning infrastructure, but they enable the
8.4M reduction in fmt.Sprintf allocation count.

ALLOCATION COUNT COMPARISON
---------------------------
                           Baseline        Optimized      Change
fmt.Sprintf:              18,628,976      10,180,087    -8,448,889 (-45%)
extractGroupKeyValues:    15,778,157               0   -15,778,157 (-100%)
Total allocations/op:      3,442,404       2,772,873      -669,531 (-19%)

KEY FINDINGS
------------
✅ Buffer reuse: Working perfectly (366 MB eliminated, 15.7M allocs removed)
✅ String interning: Working correctly (209 MB saved, 8.4M allocs removed)
⚠️  Streaming: Infrastructure added but bridge still builds RowSet
   - Needs direct callback code generation in SQL compiler
   - This is the blocker for 60% reduction target

ROOT CAUSE: sql/program_compiler.go StreamingColumnPredicate bridge
   program.StreamingColumnPredicate = func(...) {
       rowSet, err := program.ColumnPredicate(provider)  // ← Still builds RowSet!
       for _, rowIdx := range rowSet.ToSlice() {
           callback(rowIdx)
       }
   }

NEXT STEP: Generate callback-based predicate code directly, bypass RowSet

================================================================================
